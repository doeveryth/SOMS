{% extends "base.html" %}

{% block title %}보안장비 관리 · SOMS{% endblock %}

{% block content %}
<div class="py-4">
    <div class="d-flex align-items-center justify-content-between mb-4">
        <div>
            <h4 class="fw-bold mb-1 text-dark">보안장비 관리</h4>
            <div class="text-muted">전체 보안 장비 관리 및 신규 등록 (총 {{ pagination.total }}건)</div>
        </div>
        <button class="btn btn-primary btn-sm shadow-sm" onclick="openDashRegister()">
            <i class="bi bi-plus-lg me-1"></i>장비 등록
        </button>
    </div>

    <div class="card border-0 shadow-sm mb-4">
        <div class="card-body bg-light rounded-3 p-3">
            <form class="row g-2 align-items-end" method="get">
                <div class="col-md-2">
                    <label class="form-label small fw-bold text-secondary mb-1">고객사</label>
                    <input type="text" class="form-control form-control-sm" name="company" value="{{ filters.company }}">
                </div>
                <div class="col-md-2">
                    <label class="form-label small fw-bold text-secondary mb-1">장비 유형</label>
                    <select class="form-select form-select-sm" name="type">
                        <option value="">전체</option>
                        <option value="방화벽" {% if filters.type=='방화벽' %}selected{% endif %}>방화벽</option>
                        <option value="웹방화벽" {% if filters.type=='웹방화벽' %}selected{% endif %}>웹방화벽</option>
                        <option value="IPS" {% if filters.type=='IPS' %}selected{% endif %}>IPS</option>
                        <option value="DDoS" {% if filters.type=='DDoS' %}selected{% endif %}>DDoS</option>
                        <option value="VPN" {% if filters.type=='VPN' %}selected{% endif %}>VPN</option>
                        <option value="스위치" {% if filters.type=='스위치' %}selected{% endif %}>스위치</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label small fw-bold text-secondary mb-1">검색어</label>
                    <input type="text" class="form-control form-control-sm" name="q" value="{{ filters.q }}" placeholder="자산명, IP, 시리얼">
                </div>
                <div class="col-md-2 d-grid">
                    <button class="btn btn-sm btn-secondary fw-bold" type="submit">
                        <i class="bi bi-search me-1"></i>조회
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="card border-0 shadow-sm mb-4">
        <div class="card-body p-0">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0" style="width: 100%; table-layout: fixed;">
                    <colgroup>
                        <col style="width: 20%;"> <col style="width: 20%;"> <col style="width: 20%;"> <col style="width: 8%;">  <col style="width: 12%;"> <col style="width: 14%;"> <col style="width: 8%;">  <col style="width: 8%;">  <col style="width: 90px;"> </colgroup>
                    <thead class="table-light">
                        <tr class="text-secondary small text-uppercase">
                            <th class="ps-4 py-3 fw-bold">고객사</th>
                            <th class="py-3 fw-bold">사이트명</th>
                            <th class="py-3 fw-bold">장비 이름 (CI 이름)</th>
                            <th class="py-3 fw-bold text-center">제품 계층 2</th>
                            <th class="py-3 fw-bold text-center">제품 이름</th>
                            <th class="py-3 fw-bold text-center">IP</th>
                            <th class="py-3 fw-bold text-center">운영모드</th>
                            <th class="py-3 fw-bold text-center">공급자(소유)</th>
                            <th class="py-3 fw-bold text-center">관리</th>
                        </tr>
                    </thead>
                    <tbody style="font-size: 0.85rem;">
                        {% for asset, person in pagination.items %}
                        <tr class="clickable-row" onclick="openDashDetail(this)"
                            data-id="{{ asset.Asset_ID }}"
                            data-person-id="{{ asset.Person_ID }}"
                            data-company="{{ person.Company }}"
                            data-site="{{ person.Last_Name }}"

                            data-name="{{ asset.Name }}"
                            data-supplier="{{ asset.Supplier }}"
                            data-category="{{ asset.Category }}"
                            data-type="{{ asset.Type }}"
                            data-item="{{ asset.Item }}"
                            data-product="{{ asset.Product_Name }}"
                            data-model="{{ asset.Model_Number }}"
                            data-manufacturer="{{ asset.Manufacturer_Name }}"

                            data-serial="{{ asset.Serial_Number }}"
                            data-ip="{{ asset.IP_Address }}"
                            data-note="{{ asset.Short_Description }}"

                            data-maint="{{ asset.Maintenance_Company }}"
                            data-op-comp="{{ asset.Operation_Company }}"
                            data-op-mode="{{ asset.Operation_Mode }}"
                            data-idc="{{ asset.IDC_Site }}"

                            data-backup="{{ asset.C_backup }}"
                            data-cycle="{{ asset.C_cycle }}"
                            data-cnote="{{ asset.C_note }}"

                            data-status="{{ asset.AssetLifecycleStatus }}"
                            data-desc="{{ asset.Description }}"

                            data-submitter="{{ asset.Submitter if asset.Submitter else 'System' }}"
                            data-updated="{{ asset.Update_Date.strftime('%Y-%m-%d %H:%M') if asset.Update_Date else '-' }}"

                            data-purchase="{{ asset.PurchaseDate }}"
                            data-receive="{{ asset.Receive_Date }}"
                            data-install="{{ asset.InstallationDate }}"
                            data-return="{{ asset.ReturnDate }}"
                            data-disposal="{{ asset.Disposal_Date }}"
                            data-license="{{ asset.License_Expiry_Date }}">

                            <td class="ps-4"><div class="text-truncate fw-bold text-dark">{{ person.Company }}</div></td>
                            <td><div class="text-truncate">{{ person.Last_Name or '-' }}</div></td>
                            <td><div class="fw-bold text-primary text-truncate">{{ asset.Name }}</div></td>
                            <td class="text-center"><span class="badge bg-light text-dark border">{{ asset.Type }}</span></td>
                            <td class="text-center"><div class="text-truncate small">{{ asset.Product_Name or '-' }}</div></td>
                            <td class="text-center"><div class="font-monospace small text-truncate">{{ asset.IP_Address or '-' }}</div></td>
                            <td class="text-center">
                                <span class="badge bg-light text-dark border">
                                    {% if asset.Operation_Mode|string == '1' %} 탐지
                                    {% elif asset.Operation_Mode|string == '2' %} 차단
                                    {% else %} - {% endif %}
                                </span>
                            </td>
                            <td class="text-center small text-truncate">{{ asset.Supplier or '-' }}</td>
                            <td class="text-center pe-3" onclick="event.stopPropagation()">
                                <div class="d-flex justify-content-center gap-1">
                                    <button class="btn btn-outline-secondary btn-square shadow-sm"
                                            onclick="openDashEdit(this.closest('tr'))">
                                        <i class="bi bi-pencil-fill" style="font-size: 0.8rem;"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-square shadow-sm"
                                            onclick="deleteDashAsset({{ asset.Asset_ID }})">
                                        <i class="bi bi-trash-fill" style="font-size: 0.8rem;"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="9" class="text-center py-5 text-muted">등록된 보안장비가 없습니다.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    {% if pagination.pages > 1 %}
    <nav>
        <ul class="pagination justify-content-center">
            <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
                <a class="page-link border-0 rounded-circle mx-1" href="{{ url_for('asset.list_security', page=pagination.prev_num, **filters) if pagination.has_prev else '#' }}">&laquo;</a>
            </li>
            {% for p in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
                {% if p %}
                    {% if p == pagination.page %}
                    <li class="page-item active"><span class="page-link border-0 rounded-circle mx-1">{{ p }}</span></li>
                    {% else %}
                    <li class="page-item"><a class="page-link border-0 rounded-circle mx-1 text-secondary" href="{{ url_for('asset.list_security', page=p, **filters) }}">{{ p }}</a></li>
                    {% endif %}
                {% else %}
                    <li class="page-item disabled"><span class="page-link border-0 mx-1">...</span></li>
                {% endif %}
            {% endfor %}
            <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
                <a class="page-link border-0 rounded-circle mx-1" href="{{ url_for('asset.list_security', page=pagination.next_num, **filters) if pagination.has_next else '#' }}">&raquo;</a>
            </li>
        </ul>
    </nav>
    {% endif %}
</div>

<div class="modal fade" id="dashDetailModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content border-0 shadow">
            <div class="modal-header border-0 pb-0">
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body pt-0 pb-4 px-4 bg-light">

                <div class="card border-0 shadow-sm mb-3 mt-2 overflow-hidden">
                    <div class="card-body position-relative">
                        <div class="position-absolute top-0 end-0 mt-3 me-3">
                            <span class="badge rounded-pill px-3 py-2" id="view_dash_status">-</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <div class="bg-primary bg-opacity-10 text-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 56px; height: 56px;">
                                <i class="bi bi-hdd-rack-fill fs-3"></i>
                            </div>
                            <div>
                                <h4 class="fw-bold text-dark mb-1" id="view_dash_name">-</h4>
                                <div class="text-muted small">
                                    <i class="bi bi-building me-1"></i><span id="view_dash_customer">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex gap-2 mt-3">
                            <div class="bg-light border rounded px-3 py-2">
                                <span class="text-secondary small fw-bold d-block">IP Address</span>
                                <span class="font-monospace text-dark fw-bold" id="view_dash_ip">-</span>
                            </div>
                            <div class="bg-light border rounded px-3 py-2">
                                <span class="text-secondary small fw-bold d-block">Serial Number</span>
                                <span class="font-monospace text-dark" id="view_dash_serial">-</span>
                            </div>
                            <div class="bg-light border rounded px-3 py-2 flex-grow-1">
                                <span class="text-secondary small fw-bold d-block">Category</span>
                                <span class="text-dark" id="view_dash_category">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-header bg-white border-bottom-0 fw-bold text-secondary">
                                <i class="bi bi-cpu me-2"></i>하드웨어 정보
                            </div>
                            <div class="card-body pt-0">
                                <table class="table table-borderless table-sm mb-0 small">
                                    <tr><td class="text-muted" style="width:35%;">제조사</td><td class="fw-bold" id="view_dash_maker">-</td></tr>
                                    <tr><td class="text-muted">제품명</td><td id="view_dash_product">-</td></tr>
                                    <tr><td class="text-muted">모델명</td><td id="view_dash_model">-</td></tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-header bg-white border-bottom-0 fw-bold text-secondary">
                                <i class="bi bi-activity me-2"></i>운영 및 관리
                            </div>
                            <div class="card-body pt-0">
                                <table class="table table-borderless table-sm mb-0 small">
                                    <tr><td class="text-muted" style="width:35%;">운영 모드</td><td><span class="badge bg-light text-dark border" id="view_dash_mode">-</span></td></tr>
                                    <tr><td class="text-muted">운영 업체</td><td id="view_dash_op_comp">-</td></tr>
                                    <tr><td class="text-muted">유지보수</td><td id="view_dash_maint">-</td></tr>
                                    <tr><td class="text-muted">DC 위치</td><td id="view_dash_idc">-</td></tr>
                                    <tr><td class="text-muted">공급자</td><td id="view_dash_supplier">-</td></tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body">
                                <h6 class="fw-bold text-secondary small mb-3"><i class="bi bi-calendar-event me-2"></i>상세 일정 정보</h6>
                                <div class="row g-3 small">
                                    <div class="col-6 d-flex justify-content-between border-bottom pb-2">
                                        <span class="text-muted">구매일 (Purchase)</span><span class="fw-bold text-dark" id="view_dash_purchase">-</span>
                                    </div>
                                    <div class="col-6 d-flex justify-content-between border-bottom pb-2">
                                        <span class="text-muted">입고일 (Receive)</span><span class="fw-bold text-primary" id="view_dash_receive">-</span>
                                    </div>
                                    <div class="col-6 d-flex justify-content-between border-bottom pb-2">
                                        <span class="text-muted">설치일 (Install)</span><span class="fw-bold text-dark" id="view_dash_install">-</span>
                                    </div>
                                    <div class="col-6 d-flex justify-content-between border-bottom pb-2">
                                        <span class="text-muted">반환일 (Return)</span><span class="fw-bold text-dark" id="view_dash_return">-</span>
                                    </div>
                                    <div class="col-6 d-flex justify-content-between">
                                        <span class="text-muted">폐기일 (Disposal)</span><span class="fw-bold text-secondary" id="view_dash_disposal">-</span>
                                    </div>
                                    <div class="col-6 d-flex justify-content-between">
                                        <span class="text-muted">라이선스 만료</span><span class="fw-bold text-danger" id="view_dash_license">-</span>
                                    </div>
                                </div>
                                <hr class="dashed my-3">
                                <div class="row">
                                    <div class="col-12">
                                        <h6 class="fw-bold text-secondary small mb-2"><i class="bi bi-arrow-repeat me-2"></i>백업 설정</h6>
                                        <span class="badge bg-light text-dark border me-2" id="view_dash_backup">-</span>
                                        <span class="text-muted small me-2" id="view_dash_cycle">-</span>
                                        <span class="text-muted small fst-italic" id="view_dash_note"></span>
                                    </div>
                                </div>
                                <div class="mt-3 p-2 bg-light rounded small" id="view_dash_desc" style="white-space: pre-wrap;">-</div>

                                <div class="text-end mt-3 border-top pt-2">
                                    <span class="text-muted small me-3">최초 등록: <span class="fw-bold text-dark" id="view_dash_submitter">-</span></span>
                                    <span class="text-muted small">최종 수정: <span class="fw-bold text-dark" id="view_dash_updated">-</span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 pt-0 pb-4 pe-4 bg-light">
                <button type="button" class="btn btn-white border shadow-sm px-4" data-bs-dismiss="modal">닫기</button>
                <button type="button" class="btn btn-primary shadow-sm px-4" id="btnDashEdit">
                    <i class="bi bi-pencil-square me-2"></i>정보 수정
                </button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="dashEditModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-scrollable modal-lg">
        <form class="modal-content" id="dashForm">
            <input type="hidden" id="dash_asset_id" name="asset_id">

            <div class="modal-header">
                <h5 class="modal-title fw-bold" id="dashModalTitle">보안장비 관리</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body bg-light p-4">
                <div class="alert alert-info small mb-4 border-0 shadow-sm">
                    <i class="bi bi-info-circle-fill me-1"></i> 필수 항목(<span class="text-danger fw-bold">*</span>)
                </div>

                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-body">
                        <h6 class="fw-bold mb-3 text-secondary"><i class="bi bi-building me-1"></i>기본 정보</h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label small fw-bold text-primary">고객사 (Company) <span class="text-danger">*</span></label>
                                <select class="form-select select2-dash" name="person_id" id="dash_person_id" required style="width: 100%;">
                                    <option value="">고객사를 검색하세요</option>
                                    {% for c in customers %}
                                    <option value="{{ c.Person_ID }}" data-company="{{ c.Company }}">
                                        {{ c.Company }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label small fw-bold text-primary">사이트명 (Site Name) <span class="text-danger">*</span></label>
                                <input type="text" class="form-control border-primary" name="owner_name" id="dash_owner_name"
                                       placeholder="예: 게임물관리위원회(목동)" required>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="accordion" id="dashAccordion">

                    <div class="accordion-item border shadow-sm mb-2 rounded overflow-hidden">
                        <h2 class="accordion-header">
                            <button class="accordion-button fw-bold text-dark small" type="button" data-bs-toggle="collapse" data-bs-target="#colSpec">
                                <i class="bi bi-router me-2"></i>장비 정보
                            </button>
                        </h2>
                        <div id="colSpec" class="accordion-collapse collapse show" data-bs-parent="#dashAccordion">
                            <div class="accordion-body bg-light border-top">
                                <div class="row g-3 mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label small fw-bold text-secondary">CI 이름 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" name="ci_name" id="dash_ci_name" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label small fw-bold text-secondary">공급자 <span class="text-danger">*</span></label>
                                        <select class="form-select select2-dash" name="supplier" id="dash_supplier" required style="width: 100%;">
                                            <option value="">선택</option>
                                            <option value="ICTIS">ICTIS</option>
                                            <option value="고객소유">고객소유</option>
                                            <option value="기타">기타</option>
                                            <option value="임대">임대</option>
                                            <option value="펜타시큐리티">펜타시큐리티</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row g-3 mb-3">
                                    <div class="col-md-4">
                                        <label class="form-label small fw-bold text-secondary">계층 1</label>
                                        <select class="form-select" name="category" id="dash_category">
                                            <option value="보안장비">보안장비</option>
                                            <option value="보안장비_VIP">보안장비_VIP</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label small fw-bold text-secondary">계층 2</label>
                                        <select class="form-select select2-dash" name="type" id="dash_type" required style="width: 100%;">
                                            <option value="">선택</option>
                                            <option value="방화벽">방화벽</option>
                                            <option value="방화벽_VIP">방화벽_VIP</option>
                                            <option value="NGFW">NGFW</option>
                                            <option value="웹방화벽">웹방화벽</option>
                                            <option value="스위치">스위치</option>
                                            <option value="UTM">UTM</option>
                                            <option value="UTM_VIP">UTM_VIP</option>
                                            <option value="IPS">IPS</option>
                                            <option value="IDS">IDS</option>
                                            <option value="DDoS">DDoS</option>
                                            <option value="VPN">VPN</option>
                                            <option value="라우터">라우터</option>
                                            <option value="스팸스나이퍼">스팸스나이퍼</option>
                                            <option value="스팸스나이퍼_VIP">스팸스나이퍼_VIP</option>
                                            <option value="웹키퍼">웹키퍼</option>
                                            <option value="로그서버">로그서버</option>
                                            <option value="암호화솔루션">암호화솔루션</option>
                                            <option value="기타">기타</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label small fw-bold text-secondary">계층 3</label>
                                        <select class="form-select select2-dash" name="item" id="dash_item" style="width: 100%;">
                                            <option value="">선택</option>
                                            <option value="Fortinet">Fortinet</option>
                                            <option value="Ahnlab">Ahnlab</option>
                                            <option value="AIWAF">AIWAF</option>
                                            <option value="AxGate">AxGate</option>
                                            <option value="Catalyst">Catalyst</option>
                                            <option value="Cisco">Cisco</option>
                                            <option value="EX">EX</option>
                                            <option value="F5">F5</option>
                                            <option value="FortiDDoS">FortiDDoS</option>
                                            <option value="FTG">FTG</option>
                                            <option value="FutureSystems">FutureSystems</option>
                                            <option value="HansolNexG">HansolNexG</option>
                                            <option value="HP">HP</option>
                                            <option value="ICTIS">ICTIS</option>
                                            <option value="ISG">ISG</option>
                                            <option value="iwall">iwall</option>
                                            <option value="Juniper">Juniper</option>
                                            <option value="L4">L4</option>
                                            <option value="L4 Alteon 180E">L4 Alteon 180E</option>
                                            <option value="L4 PumPkin">L4 PumPkin</option>
                                            <option value="MF2">MF2</option>
                                            <option value="MFI">MFI</option>
                                            <option value="Monitorapp">Monitorapp</option>
                                            <option value="NE">NE</option>
                                            <option value="Paloalto">Paloalto</option>
                                            <option value="Penta">Penta</option>
                                            <option value="Piolink">Piolink</option>
                                            <option value="PulseSecure">PulseSecure</option>
                                            <option value="RUCKUS">RUCKUS</option>
                                            <option value="Secui">Secui</option>
                                            <option value="SG2024">SG2024</option>
                                            <option value="Sniper">Sniper</option>
                                            <option value="SRX">SRX</option>
                                            <option value="SSG">SSG</option>
                                            <option value="TG">TG</option>
                                            <option value="TrendMicro">TrendMicro</option>
                                            <option value="UTM_VIP">UTM_VIP</option>
                                            <option value="VIP">VIP</option>
                                            <option value="Wapples">Wapples</option>
                                            <option value="Web Front">Web Front</option>
                                            <option value="Wins">Wins</option>
                                            <option value="XIOS">XIOS</option>
                                            <option value="로그서버">로그서버</option>
                                            <option value="방화벽_VIP">방화벽_VIP</option>
                                            <option value="스팸스나이퍼">스팸스나이퍼</option>
                                            <option value="스팸스나이퍼_VIP">스팸스나이퍼_VIP</option>
                                            <option value="웹키퍼">웹키퍼</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row g-3">
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">제품명</label><input type="text" class="form-control" name="product_name" id="dash_product_name"></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">모델</label><input type="text" class="form-control" name="model_number" id="dash_model_number"></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">제조사</label><input type="text" class="form-control" name="manufacturer_name" id="dash_manufacturer_name"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="accordion-item border shadow-sm mb-2 rounded overflow-hidden">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed fw-bold text-dark small" type="button" data-bs-toggle="collapse" data-bs-target="#colOp">
                                <i class="bi bi-tools me-2"></i>운영 및 백업
                            </button>
                        </h2>
                        <div id="colOp" class="accordion-collapse collapse" data-bs-parent="#dashAccordion">
                            <div class="accordion-body bg-light border-top">
                                <div class="row g-3 mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label small fw-bold text-secondary">유지보수업체</label>
                                        <select class="form-select select2-dash" name="maintenance_company" id="dash_maintenance_company" style="width: 100%;">
                                            <option value="12">없음</option>
                                            <option value="0">ICTIS</option>
                                            <option value="11">고객사 유지보수</option>
                                            <option value="1">에스에이정보기술</option>
                                            <option value="2">블루시큐어</option>
                                            <option value="3">유콘텍</option>
                                            <option value="4">유니포인트</option>
                                            <option value="5">엔큐리티</option>
                                            <option value="6">시큐트러스트</option>
                                            <option value="7">모니터랩</option>
                                            <option value="8">인스테크</option>
                                            <option value="9">쿼리시스템즈</option>
                                            <option value="10">에스디씨디엠</option>
                                            <option value="13">윈스</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6"><label class="form-label small fw-bold text-secondary">운영업체</label><select class="form-select" name="operation_company" id="dash_operation_company"><option value="0">ICTIS</option><option value="1">고객사</option></select></div>
                                    <div class="col-md-6"><label class="form-label small fw-bold text-secondary">운영모드</label><select class="form-select" name="operation_mode" id="dash_operation_mode"><option value="0">해당 없음</option><option value="1">탐지</option><option value="2">차단</option></select></div>
                                    <div class="col-md-6"><label class="form-label small fw-bold text-secondary">DC</label><input type="text" class="form-control" name="idc_site" id="dash_idc_site"></div>
                                </div>
                                <hr class="dashed my-2">
                                <div class="row g-3">
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">백업 여부</label><select class="form-select" name="c_backup" id="dash_c_backup"><option value="0">YES</option><option value="1">NO</option></select></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">주기</label><select class="form-select" name="c_cycle" id="dash_c_cycle"><option value="0">Daily</option><option value="1">Weekly</option><option value="2">Monthly</option></select></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">백업 특이사항</label><input type="text" class="form-control" name="cfg_note" id="dash_cfg_note"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="accordion-item border shadow-sm rounded overflow-hidden">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed fw-bold text-dark small" type="button" data-bs-toggle="collapse" data-bs-target="#colStatus">
                                <i class="bi bi-calendar-check me-2"></i>식별 정보 및 날짜
                            </button>
                        </h2>
                        <div id="colStatus" class="accordion-collapse collapse" data-bs-parent="#dashAccordion">
                            <div class="accordion-body bg-light border-top">
                                <div class="row g-3 mb-3">
                                    <div class="col-md-6"><label class="form-label small fw-bold text-secondary">S/N</label><input type="text" class="form-control" name="serial_number" id="dash_serial_number"></div>
                                    <div class="col-md-6"><label class="form-label small fw-bold text-secondary">IP</label><input type="text" class="form-control font-monospace" name="ip_address" id="dash_ip_address"></div>
                                    <div class="col-12"><label class="form-label small fw-bold text-secondary">장비 특이사항</label><textarea class="form-control" name="ci_note" id="dash_ci_note" rows="2"></textarea></div>
                                </div>
                                <hr class="dashed my-2">
                                <div class="row g-3">
                                    <div class="col-12"><label class="form-label small fw-bold text-secondary">상태</label><select class="form-select" name="lifecycle_status" id="dash_lifecycle_status"><option value="3">사용중</option><option value="0">주문됨</option><option value="1">입고됨</option><option value="11">폐기</option></select></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">구매일</label><input type="date" class="form-control" name="purchase_date" id="dash_purchase_date"></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">입고일</label><input type="date" class="form-control" name="receive_date" id="dash_receive_date"></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">설치일</label><input type="date" class="form-control" name="installation_date" id="dash_installation_date"></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">반환일</label><input type="date" class="form-control" name="return_date" id="dash_return_date"></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">라이선스 만료일</label><input type="date" class="form-control" name="license_expiry" id="dash_license_expiry"></div>
                                    <div class="col-md-4"><label class="form-label small fw-bold text-secondary">폐기일</label><input type="date" class="form-control" name="disposal_date" id="dash_disposal_date"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-3">
                    <label class="form-label small fw-bold text-secondary">비고</label>
                    <textarea class="form-control" name="description" id="dash_description" rows="2"></textarea>
                </div>
            </div>
            <div class="modal-footer bg-white border-top-0 py-3">
                <button type="button" class="btn btn-light" data-bs-dismiss="modal">취소</button>
                <button type="button" class="btn btn-primary px-4 fw-bold" onclick="saveDashAsset()">
                    <i class="bi bi-check-lg me-1"></i> 저장하기
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}