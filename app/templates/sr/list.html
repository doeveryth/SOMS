{% extends "base.html" %}
{% block title %}SR 관리 · SOMS{% endblock %}

{% block content %}
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@latest/dist/web/static/pretendard.css" />

  <link href="{{ url_for('static', filename='css/soms.css') }}" rel="stylesheet">
</head>

<div class="soms-page">
  <div class="soms-page-header">
    <div>
    <div class="h4 mb-0 soms-page-title">SR 관리</div>
    <div class="soms-page-subtitle">고객사/위치/요청일/내용/처리자 필수 · 등록/조회/수정/삭제</div>
  </div>
    <button class="btn btn-primary btn-sm" type="button" data-bs-toggle="modal" data-bs-target="#srCreateModal">
      SR 등록
    </button>
  </div>

  <form class="row g-2 align-items-end mb-3" method="get" action="{{ url_for('sr.list_sr') }}">
    <div class="col-md-2">
      <label class="form-label small text-muted mb-1">위치</label>
      <input class="form-control form-control-sm" name="location" value="{{ filters.location }}" />
    </div>
    <div class="col-md-2">
      <label class="form-label small text-muted mb-1">고객사</label>
      <input class="form-control form-control-sm" name="company" value="{{ filters.company }}" />
    </div>
    <div class="col-md-3">
      <label class="form-label small text-muted mb-1">내용</label>
      <input class="form-control form-control-sm" name="content" value="{{ filters.content }}" />
    </div>
    <div class="col-md-2">
      <label class="form-label small text-muted mb-1">조회기간 From</label>
      <input type="date" class="form-control form-control-sm" name="from" value="{{ filters['from'] }}" />
    </div>
    <div class="col-md-2">
      <label class="form-label small text-muted mb-1">조회기간 To</label>
      <input type="date" class="form-control form-control-sm" name="to" value="{{ filters['to'] }}" />
    </div>
    <div class="col-md-1 d-grid">
      <button class="btn btn-sm btn-secondary" type="submit">조회</button>
    </div>
  </form>

  <div class="card border-0 shadow-sm">
    <div class="table-responsive">
      <table class="table table-sm mb-0 align-middle">
        <thead class="table-light">
          <tr>
            <th style="width: 90px;">ID</th>
            <th style="width: 140px;">위치</th>
            <th style="width: 220px;">고객사</th>
            <th style="width: 140px;">요청일</th>
            <th>내용</th>
            <th style="width: 140px;">처리자</th>
            <th style="width: 80px;">수정</th>
            <th style="width: 80px;">삭제</th>
          </tr>
        </thead>
        <tbody>
          {% for it in items %}
            <tr>
              <td class="text-muted">{{ it.sr_id }}</td>
              <td>{{ it.location }}</td>
              <td>{{ it.company }}</td>
              <td>{{ it.request_date }}</td>
              <td>{{ it.content }}</td>
              <td>{{ it.handler }}</td>
              <td>
                <a class="btn btn-sm btn-primary" href="{{ url_for('sr.edit_sr', sr_id=it.sr_id) }}">수정</a>
              </td>
              <td>
                <form method="post" action="{{ url_for('sr.delete_sr', sr_id=it.sr_id) }}" onsubmit="return confirm('정말 삭제하시겠습니까?');">
                  <button class="btn btn-sm btn-danger" type="submit">삭제</button>
                </form>
              </td>
            </tr>
          {% else %}
            <tr>
              <td colspan="8" class="text-center text-muted py-4">데이터가 없습니다.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}